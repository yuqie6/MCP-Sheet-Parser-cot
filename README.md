# MCP Sheet Parser

ä¸€ä¸ªé«˜æ•ˆã€ä¸“ä¸šçš„è¡¨æ ¼æ–‡ä»¶è§£æå’ŒHTMLè½¬æ¢MCPæœåŠ¡å™¨ï¼Œä¸“æ³¨äº95%æ ·å¼ä¿çœŸåº¦å’Œæ™ºèƒ½æ€§èƒ½ä¼˜åŒ–ã€‚

## ğŸš€ æ ¸å¿ƒç‰¹æ€§

### ğŸ“Š å¤šæ ¼å¼æ”¯æŒ
- **XLSX** - ç°ä»£Excelæ ¼å¼ï¼ˆå®Œæ•´æ ·å¼æ”¯æŒï¼‰
- **CSV** - é€šç”¨æ–‡æœ¬æ ¼å¼
- **XLS** - ä¼ ç»ŸExcelæ ¼å¼
- **XLSB** - ExceläºŒè¿›åˆ¶æ ¼å¼

### ğŸ¨ é«˜ä¿çœŸæ ·å¼è½¬æ¢
- **95%æ ·å¼ä¿çœŸåº¦** - ç²¾ç¡®è¿˜åŸåŸå§‹è¡¨æ ¼æ ·å¼
- **å®Œæ•´æ ·å¼æ”¯æŒ** - å­—ä½“ã€é¢œè‰²ã€èƒŒæ™¯ã€è¾¹æ¡†ã€å¯¹é½ç­‰
- **è¿›é˜¶åŠŸèƒ½** - è¶…é“¾æ¥ã€å•å…ƒæ ¼æ³¨é‡Šã€åˆå¹¶å•å…ƒæ ¼
- **CSSä¼˜åŒ–** - æ™ºèƒ½ç±»å¤ç”¨ï¼Œå‡å°‘87%æ–‡ä»¶å¤§å°

### âš¡ æ™ºèƒ½æ€§èƒ½ä¼˜åŒ–
- **æ™ºèƒ½å¤„ç†ç­–ç•¥** - æ ¹æ®æ–‡ä»¶å¤§å°è‡ªåŠ¨é€‰æ‹©æœ€ä½³å¤„ç†æ–¹å¼
- **åˆ†é¡µå¤„ç†** - å¤§æ–‡ä»¶è‡ªåŠ¨åˆ†é¡µï¼Œé¿å…æ€§èƒ½é—®é¢˜
- **æ€§èƒ½ç›‘æ§** - å®æ—¶åˆ†æå¤„ç†æ—¶é—´å’Œèµ„æºæ¶ˆè€—
- **å¤§å°ä¼°ç®—** - å‡†ç¡®é¢„æµ‹HTMLå’ŒJSONè¾“å‡ºå¤§å°

### ğŸ› ï¸ å®Œæ•´MCPå·¥å…·é“¾
- **parse_sheet_to_json** - è§£æä¸ºLLMå‹å¥½çš„JSONæ ¼å¼
- **convert_json_to_html** - JSONåˆ°å®Œç¾HTMLæ–‡ä»¶è½¬æ¢
- **convert_file_to_html** - æ™ºèƒ½ç›´æ¥è½¬æ¢
- **convert_file_to_html_file** - æ–‡ä»¶è¾“å‡ºæ¨¡å¼
- **get_table_summary** - è¡¨æ ¼æ¦‚è§ˆå’Œæ€§èƒ½åˆ†æ
- **get_sheet_metadata** - è¯¦ç»†å…ƒæ•°æ®ä¿¡æ¯
- **convert_file_to_html_paginated** - å¤§æ–‡ä»¶åˆ†é¡µå¤„ç†

## ğŸ“¦ å®‰è£…å’Œä½¿ç”¨

### ç¯å¢ƒè¦æ±‚
- Python 3.11+
- uv åŒ…ç®¡ç†å™¨

### å®‰è£…ä¾èµ–
```bash
uv install
```

### å¯åŠ¨MCPæœåŠ¡å™¨
```bash
uv run python src/main.py
```

### è¿è¡Œæµ‹è¯•
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
uv run python -m pytest

# è¿è¡Œæµ‹è¯•è¦†ç›–ç‡åˆ†æ
uv run python -m pytest --cov=src --cov-report=term-missing

# è¿è¡Œç‰¹å®šæµ‹è¯•æ¨¡å—
uv run python -m pytest tests/test_integration.py -v
```

## ğŸ”§ å·¥å…·ä½¿ç”¨æŒ‡å—

### 1. å¿«é€Ÿè½¬æ¢å·¥ä½œæµç¨‹
```json
{
  "tool": "convert_file_to_html",
  "arguments": {
    "file_path": "data/sample.xlsx"
  }
}
```

### 2. å®Œç¾å¤åˆ»å·¥ä½œæµç¨‹
```json
// æ­¥éª¤1ï¼šè§£æä¸ºJSON
{
  "tool": "parse_sheet_to_json",
  "arguments": {
    "file_path": "data/sample.xlsx"
  }
}

// æ­¥éª¤2ï¼šç”Ÿæˆå®Œç¾HTMLæ–‡ä»¶
{
  "tool": "convert_json_to_html",
  "arguments": {
    "json_data": {...},
    "output_path": "output/perfect.html"
  }
}
```

### 3. å¤§æ–‡ä»¶å¤„ç†å·¥ä½œæµç¨‹
```json
{
  "tool": "convert_file_to_html_paginated",
  "arguments": {
    "file_path": "data/large_file.xlsx",
    "output_dir": "output/pages",
    "max_rows_per_page": 1000
  }
}
```

### 4. è¡¨æ ¼åˆ†æå·¥ä½œæµç¨‹
```json
{
  "tool": "get_table_summary",
  "arguments": {
    "file_path": "data/sample.xlsx"
  }
}
```

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

### å¤„ç†èƒ½åŠ›
- **å°æ–‡ä»¶** (<1,000å•å…ƒæ ¼): ç›´æ¥è¿”å›HTMLï¼Œå“åº”æ—¶é—´ <1ç§’
- **ä¸­æ–‡ä»¶** (<10,000å•å…ƒæ ¼): æ™ºèƒ½å»ºè®®ï¼Œå“åº”æ—¶é—´ <5ç§’
- **å¤§æ–‡ä»¶** (<50,000å•å…ƒæ ¼): æ¨èæ–‡ä»¶è¾“å‡º
- **è¶…å¤§æ–‡ä»¶** (â‰¥50,000å•å…ƒæ ¼): è‡ªåŠ¨åˆ†é¡µå¤„ç†

### ä¼˜åŒ–æ•ˆæœ
- **HTMLå¤§å°å‡å°‘**: 87% (é€šè¿‡CSSç±»å¤ç”¨)
- **æ ·å¼ä¿çœŸåº¦**: 95%
- **JSONç´§å‡‘åº¦**: æ¯”HTMLå°60%
- **å¤„ç†é€Ÿåº¦**: 1000è¡Œ/ç§’

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### ä¸‰å±‚æ¶æ„
```
MCPæ¥å£å±‚ (tools.py)
    â†“
ä¸šåŠ¡é€»è¾‘å±‚ (sheet_service.py)
    â†“
å®ç°å±‚ (parsers, converters, models)
```

### æ ¸å¿ƒç»„ä»¶
- **è§£æå™¨å·¥å‚** - ç»Ÿä¸€ç®¡ç†å¤šæ ¼å¼è§£æå™¨
- **HTMLè½¬æ¢å™¨** - é«˜ä¿çœŸæ ·å¼è½¬æ¢å’Œä¼˜åŒ–
- **JSONè½¬æ¢å™¨** - LLMå‹å¥½çš„æ•°æ®åºåˆ—åŒ–
- **æ€§èƒ½ä¼˜åŒ–å™¨** - æ™ºèƒ½å¤„ç†ç­–ç•¥å’Œç›‘æ§
- **æ ·å¼å¼•æ“** - 95%ä¿çœŸåº¦æ ·å¼æ˜ å°„

## ğŸ§ª æµ‹è¯•è¦†ç›–

### æµ‹è¯•ç»Ÿè®¡
- **æ€»æµ‹è¯•ç”¨ä¾‹**: 72ä¸ª
- **æµ‹è¯•è¦†ç›–ç‡**: 80%+
- **é›†æˆæµ‹è¯•**: ç«¯åˆ°ç«¯å·¥ä½œæµç¨‹éªŒè¯
- **æ€§èƒ½æµ‹è¯•**: ä¸åŒæ–‡ä»¶å¤§å°çš„å¤„ç†éªŒè¯
- **é”™è¯¯å¤„ç†æµ‹è¯•**: è¾¹ç•Œæƒ…å†µå’Œå¼‚å¸¸å¤„ç†

### æµ‹è¯•ç±»å‹
- **å•å…ƒæµ‹è¯•** - æ¯ä¸ªæ¨¡å—çš„æ ¸å¿ƒåŠŸèƒ½
- **é›†æˆæµ‹è¯•** - ç»„ä»¶é—´åä½œéªŒè¯
- **æ€§èƒ½æµ‹è¯•** - å¤„ç†èƒ½åŠ›å’Œä¼˜åŒ–æ•ˆæœ
- **MCPå·¥å…·æµ‹è¯•** - å·¥å…·æ¥å£å’Œå‚æ•°éªŒè¯

## ğŸ“ˆ è´¨é‡ä¿è¯

### ä»£ç è´¨é‡
- **ç®€æ´æ¶æ„** - å•ä¸€èŒè´£ï¼Œä½è€¦åˆ
- **ç±»å‹æç¤º** - å®Œæ•´çš„ç±»å‹æ³¨è§£
- **æ–‡æ¡£å®Œæ•´** - è¯¦ç»†çš„ä»£ç æ³¨é‡Šå’ŒAPIæ–‡æ¡£
- **é”™è¯¯å¤„ç†** - ä¼˜é›…çš„å¼‚å¸¸å¤„ç†å’Œç”¨æˆ·åé¦ˆ

### æ€§èƒ½æ ‡å‡†
- **å“åº”æ—¶é—´** - å°æ–‡ä»¶<1ç§’ï¼Œä¸­æ–‡ä»¶<5ç§’
- **å†…å­˜ä½¿ç”¨** - æ™ºèƒ½æµå¼å¤„ç†ï¼Œé¿å…å†…å­˜æº¢å‡º
- **æ–‡ä»¶å¤§å°** - HTMLä¼˜åŒ–å‡å°‘87%ï¼ŒJSONç´§å‡‘æ ¼å¼
- **å¹¶å‘æ”¯æŒ** - æ— çŠ¶æ€è®¾è®¡ï¼Œæ”¯æŒå¹¶å‘å¤„ç†

## ğŸ”® æœªæ¥è§„åˆ’

### å³å°†æ¨å‡º
- **å›¾è¡¨è½¬æ¢** - Excelå›¾è¡¨åˆ°SVG/Canvasè½¬æ¢
- **å…¬å¼æ”¯æŒ** - åŸºç¡€å…¬å¼è®¡ç®—å’Œæ˜¾ç¤º
- **æ›´å¤šæ ¼å¼** - WPSæ ¼å¼(.et, .ett)æ”¯æŒ
- **äº‘ç«¯éƒ¨ç½²** - Dockerå®¹å™¨åŒ–å’Œäº‘æœåŠ¡æ”¯æŒ


