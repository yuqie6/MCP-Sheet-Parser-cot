# MCP è¡¨æ ¼è§£æå™¨

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Python 3.8+](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)
[![MCP](https://img.shields.io/badge/MCP-Compatible-green.svg)](https://modelcontextprotocol.io/)

ä¸€ä¸ªä¸“ä¸º **æ¨¡å‹ä¸Šä¸‹æ–‡åè®® (MCP) æœåŠ¡å™¨** è®¾è®¡çš„é«˜ä¿çœŸè¡¨æ ¼è§£æå™¨å’ŒHTMLè½¬æ¢å™¨ã€‚è¯¥å·¥å…·ä½¿llmèƒ½å¤Ÿæ— ç¼è¯»å–ã€åˆ†æå’Œä¿®æ”¹è¡¨æ ¼æ–‡ä»¶ã€è½¬åŒ–ä¸ºhtmlï¼Œå¹¶å®Œæ•´ä¿ç•™æ ·å¼ã€‚

## ğŸš€ ä»€ä¹ˆæ˜¯ MCP è¡¨æ ¼è§£æå™¨ï¼Ÿ

MCP è¡¨æ ¼è§£æå™¨æ˜¯ä¸€ä¸ª **æ¨¡å‹ä¸Šä¸‹æ–‡åè®®æœåŠ¡å™¨**ï¼Œä¸ºAIåŠ©æ‰‹æä¾›å¼ºå¤§çš„è¡¨æ ¼å¤„ç†èƒ½åŠ›ã€‚å®ƒå……å½“AIæ¨¡å‹ä¸è¡¨æ ¼æ–‡ä»¶ä¹‹é—´çš„æ¡¥æ¢ï¼Œæä¾›ä¸‰ä¸ªæ ¸å¿ƒå·¥å…·ï¼š

- **`parse_sheet`** - å°†ä»»ä½•è¡¨æ ¼è§£æä¸ºAIå‹å¥½çš„JSONæ ¼å¼
- **`convert_to_html`** - ç”Ÿæˆä¿ç•™æ ·å¼çš„é«˜ä¿çœŸHTML
- **`apply_changes`** - å°†ä¿®æ”¹åçš„æ•°æ®å†™å›åŸå§‹æ–‡ä»¶

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸ¯ **é«˜ä¿çœŸè§£æ**
- **å¤šæ ¼å¼æ”¯æŒ**: Excel (.xlsx, .xlsm, .xls, .xlsb)ã€CSVç­‰å¤šç§æ ¼å¼
- **å®Œæ•´æ ·å¼ä¿ç•™**: å­—ä½“ã€é¢œè‰²ã€è¾¹æ¡†ã€å¯¹é½æ–¹å¼ã€èƒŒæ™¯è‰²
- **ç»“æ„å®Œæ•´æ€§**: åˆå¹¶å•å…ƒæ ¼ã€å…¬å¼å’Œæ•°æ®ç±»å‹ä¿æŒä¸å˜
- **å¤§æ–‡ä»¶å¤„ç†**: è‡ªåŠ¨æµå¼å¤„ç†ä»¥ä¼˜åŒ–æ€§èƒ½

### ğŸ¤– **AIä¼˜åŒ–è®¾è®¡**
- **ä¸Šä¸‹æ–‡å‹å¥½**: é»˜è®¤è¿”å›æ¦‚è§ˆæ•°æ®ï¼Œé¿å…LLMä¸Šä¸‹æ–‡çˆ†ç‚¸
- **æ™ºèƒ½åˆ†å±‚**: æ¦‚è§ˆâ†’é‡‡æ ·â†’å®Œæ•´æ•°æ®ï¼ŒæŒ‰éœ€åŠ è½½
- **å‚æ•°åŒ–æ§åˆ¶**: LLMå¯è‡ªä¸»å†³å®šæ•°æ®è¯¦ç»†ç¨‹åº¦
- **ä½¿ç”¨æŒ‡å¯¼**: è‡ªåŠ¨æä¾›ä¸‹ä¸€æ­¥æ“ä½œå»ºè®®
- **çµæ´»èŒƒå›´é€‰æ‹©**: è§£æç‰¹å®šå•å…ƒæ ¼ã€èŒƒå›´æˆ–æ•´ä¸ªå·¥ä½œè¡¨
- **å¤šå·¥ä½œè¡¨æ”¯æŒ**: å¤„ç†åŒ…å«å¤šä¸ªå·¥ä½œè¡¨çš„å¤æ‚å·¥ä½œç°¿

### ğŸ”§ **ç”Ÿäº§å°±ç»ª**
- **MCPåè®®å…¼å®¹**: å®Œå…¨å…¼å®¹Claude Desktopå’Œå…¶ä»–MCPå®¢æˆ·ç«¯
- **é”™è¯¯å¤„ç†**: å¼ºå¤§çš„é”™è¯¯æŠ¥å‘Šå’Œæ¢å¤æœºåˆ¶
- **æ€§èƒ½ä¼˜åŒ–**: é«˜æ•ˆçš„å†…å­˜ä½¿ç”¨å’Œå¤„ç†
- **å¤‡ä»½æ”¯æŒ**: ä¿®æ”¹å‰è‡ªåŠ¨åˆ›å»ºæ–‡ä»¶å¤‡ä»½

## ğŸ› ï¸ å®‰è£…

### å‰ç½®è¦æ±‚
- Python 3.8 æˆ–æ›´é«˜ç‰ˆæœ¬
- [uv](https://docs.astral.sh/uv/) (æ¨èçš„åŒ…ç®¡ç†å™¨)
- Claude Desktop æˆ–å…¶ä»–å…¼å®¹MCPçš„å®¢æˆ·ç«¯ï¼Œæ¯”å¦‚Cherry stdio

### ä»æºç å®‰è£…
```bash
git clone https://github.com/yuqie6/MCP-Sheet-Parser.git
cd MCP-Sheet-Parser
uv sync
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. é…ç½® Claude Desktop

å°†æ­¤æœåŠ¡å™¨æ·»åŠ åˆ°æ‚¨çš„ Claude Desktop é…ç½®æ–‡ä»¶ä¸­ï¼š

**macOS**: `~/Library/Application Support/Claude/claude_desktop_config.json`
**Windows**: `%APPDATA%/Claude/claude_desktop_config.json`

```json
{
  "mcpServers": {
    "sheet-parser": {
      "command": "uv",
      "args": [
        "--directory",
        "path/MCP-Sheet-Parser-cot",
        "run",
        "main.py"
      ]
    }
  }
}
```

> **æ³¨æ„**: è¯·å°† `path/MCP-Sheet-Parser-cot` æ›¿æ¢ä¸ºæ‚¨çš„å®é™…é¡¹ç›®ç›®å½•è·¯å¾„ã€‚

### 2. é…ç½®cherry stdio

å‘½ä»¤å¡«å†™ **uv**

å‚æ•°å¡«å†™ï¼š
> --directory
> 
> path\MCP-Sheet-Parser-cot
> 
> run
> 
> main.py
> 
è·¯å¾„è¯·å¡«å†™ç»å¯¹è·¯å¾„

### 3. åœ¨ Claude Desktop ä¸­å¼€å§‹ä½¿ç”¨

é…ç½®å®Œæˆåï¼Œé‡å¯ Claude Desktopï¼Œæ‚¨å°±å¯ä»¥è®© Claude å¤„ç†è¡¨æ ¼äº†ï¼š

> "è¯·è§£æ `/path/to/sales.xlsx` ä¸­çš„é”€å”®æ•°æ®å¹¶æ˜¾ç¤ºæ‘˜è¦"

> "å°†path/name.xlsxè½¬æ¢ä¸ºHTMLï¼ˆç»å¯¹è·¯å¾„ï¼‰"

> "æ›´æ–°åº“å­˜è¡¨æ ¼ï¼Œå°†æ‰€æœ‰æ•°é‡å¢åŠ 10%"

## ğŸ”§ å¯ç”¨å·¥å…·

### `parse_sheet`
å°†è¡¨æ ¼æ–‡ä»¶è§£æä¸ºAIå‹å¥½çš„JSONæ ¼å¼ã€‚é»˜è®¤è¿”å›æ¦‚è§ˆä¿¡æ¯ï¼Œå¯æŒ‰éœ€è·å–è¯¦ç»†æ•°æ®ã€‚

**å‚æ•°:**
- `file_path` (å¿…éœ€): è¡¨æ ¼æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼Œæ”¯æŒ .csv, .xlsx, .xls, .xlsb, .xlsm æ ¼å¼
- `sheet_name` (å¯é€‰): è¦è§£æçš„å·¥ä½œè¡¨åç§°ï¼Œç•™ç©ºåˆ™ä½¿ç”¨ç¬¬ä¸€ä¸ªå·¥ä½œè¡¨
- `range_string` (å¯é€‰): å•å…ƒæ ¼èŒƒå›´ï¼Œå¦‚ "A1:D10"ï¼ŒæŒ‡å®šèŒƒå›´æ—¶è¿”å›è¯¥èŒƒå›´çš„å®Œæ•´æ•°æ®
- `include_full_data` (å¯é€‰ï¼Œé»˜è®¤false): æ˜¯å¦è¿”å›å®Œæ•´æ•°æ®ï¼Œfalseæ—¶åªè¿”å›æ¦‚è§ˆå’Œé¢„è§ˆ
- `include_styles` (å¯é€‰ï¼Œé»˜è®¤false): æ˜¯å¦åŒ…å«æ ·å¼ä¿¡æ¯ï¼ˆå­—ä½“ã€é¢œè‰²ã€è¾¹æ¡†ç­‰ï¼‰
- `preview_rows` (å¯é€‰ï¼Œé»˜è®¤5): é¢„è§ˆè¡Œæ•°ï¼Œå½“include_full_dataä¸ºfalseæ—¶ç”Ÿæ•ˆ
- `max_rows` (å¯é€‰): æœ€å¤§è¿”å›è¡Œæ•°ï¼Œç”¨äºé™åˆ¶å¤§æ–‡ä»¶çš„æ•°æ®é‡

**ä½¿ç”¨ç¤ºä¾‹:**

```json
// åŸºç¡€æ¦‚è§ˆï¼ˆæ¨èé¦–æ¬¡ä½¿ç”¨ï¼‰
{
  "file_path": "/path/to/data.xlsx"
}

// è·å–ç‰¹å®šå·¥ä½œè¡¨çš„å®Œæ•´æ•°æ®
{
  "file_path": "/path/to/data.xlsx",
  "sheet_name": "é”€å”®æ•°æ®",
  "include_full_data": true,
  "max_rows": 100
}

// è·å–æŒ‡å®šèŒƒå›´çš„æ•°æ®ï¼ˆåŒ…å«æ ·å¼ï¼‰
{
  "file_path": "/path/to/data.xlsx",
  "range_string": "A1:E50",
  "include_styles": true
}
```

### `convert_to_html`
å°†è¡¨æ ¼æ–‡ä»¶è½¬æ¢ä¸ºä¿ç•™æ ·å¼çš„é«˜ä¿çœŸHTMLï¼Œæ”¯æŒå¤šå·¥ä½œè¡¨å’Œåˆ†é¡µåŠŸèƒ½ã€‚

**å‚æ•°:**
- `file_path` (å¿…éœ€): æºè¡¨æ ¼æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼Œæ”¯æŒ .csv, .xlsx, .xls, .xlsb, .xlsm æ ¼å¼
- `output_path` (å¯é€‰): è¾“å‡ºHTMLæ–‡ä»¶çš„è·¯å¾„ï¼Œç•™ç©ºåˆ™åœ¨æºæ–‡ä»¶ç›®å½•ç”ŸæˆåŒå.htmlæ–‡ä»¶
- `sheet_name` (å¯é€‰): è¦è½¬æ¢çš„å•ä¸ªå·¥ä½œè¡¨åç§°ï¼Œç•™ç©ºåˆ™è½¬æ¢æ‰€æœ‰å·¥ä½œè¡¨
- `page_size` (å¯é€‰ï¼Œé»˜è®¤100): åˆ†é¡µæ—¶æ¯é¡µæ˜¾ç¤ºçš„è¡Œæ•°ï¼Œç”¨äºæ§åˆ¶å¤§å‹æ–‡ä»¶çš„å•é¡µå¤§å°
- `page_number` (å¯é€‰ï¼Œé»˜è®¤1): è¦æŸ¥çœ‹çš„é¡µç ï¼Œä»1å¼€å§‹ï¼Œç”¨äºæµè§ˆå¤§å‹æ–‡ä»¶çš„ç‰¹å®šé¡µé¢
- `header_rows` (å¯é€‰ï¼Œé»˜è®¤1): å°†æ–‡ä»¶é¡¶éƒ¨çš„æŒ‡å®šè¡Œæ•°è§†ä¸ºè¡¨å¤´

**ç¤ºä¾‹:**
```json
// è½¬æ¢æ•´ä¸ªæ–‡ä»¶
{
  "file_path": "/path/to/report.xlsx",
  "output_path": "/path/to/report.html"
}

// è½¬æ¢ç‰¹å®šå·¥ä½œè¡¨å¹¶åˆ†é¡µ
{
  "file_path": "/path/to/large_data.xlsx",
  "sheet_name": "æ•°æ®è¡¨",
  "page_size": 50,
  "page_number": 1
}
```

### `apply_changes`
å°†ä¿®æ”¹åçš„æ•°æ®å†™å›åŸå§‹è¡¨æ ¼æ–‡ä»¶ï¼Œå®Œæˆæ•°æ®ç¼–è¾‘é—­ç¯ã€‚

**å‚æ•°:**
- `file_path` (å¿…éœ€): éœ€è¦å†™å›æ•°æ®çš„ç›®æ ‡æ–‡ä»¶çš„ç»å¯¹è·¯å¾„
- `table_model_json` (å¿…éœ€): ä» `parse_sheet` å·¥å…·è·å–å¹¶ä¿®æ”¹åçš„ TableModel JSON æ•°æ®
  - å¿…é¡»åŒ…å«: `sheet_name` (å­—ç¬¦ä¸²), `headers` (å­—ç¬¦ä¸²æ•°ç»„), `rows` (äºŒç»´æ•°ç»„)
- `create_backup` (å¯é€‰ï¼Œé»˜è®¤true): æ˜¯å¦åœ¨å†™å…¥å‰åˆ›å»ºåŸå§‹æ–‡ä»¶çš„å¤‡ä»½ï¼Œé˜²æ­¢æ„å¤–è¦†ç›–

**ç¤ºä¾‹:**
```json
{
  "file_path": "/path/to/data.xlsx",
  "table_model_json": {
    "sheet_name": "é”€å”®æ•°æ®",
    "headers": ["æ—¥æœŸ", "äº§å“", "é”€é‡", "é‡‘é¢"],
    "rows": [
      ["2024-01-01", "äº§å“A", 100, 5000],
      ["2024-01-02", "äº§å“B", 150, 7500]
    ]
  },
  "create_backup": true
}
```

## ğŸ—ï¸ æ¶æ„

```
Claude Desktop (MCP å®¢æˆ·ç«¯)
           â†“
    JSON-RPC over stdin/stdout
           â†“
    MCP è¡¨æ ¼è§£ææœåŠ¡å™¨
           â†“
      æ ¸å¿ƒæœåŠ¡å±‚
           â†“
    æ ¼å¼ç‰¹å®šè§£æå™¨
    (XLSX, XLS, CSV, XLSB, XLSM)
```

## ğŸ§ª å¼€å‘

### è®¾ç½®å¼€å‘ç¯å¢ƒ
```bash
git clone https://github.com/yuqie6/MCP-Sheet-Parser.git
cd MCP-Sheet-Parser
uv sync --dev
```

### è¿è¡Œæµ‹è¯•
```bash
# ä½¿ç”¨ uv (æ¨è)
uv run pytest tests/ -v

# æˆ–ä½¿ç”¨ä¼ ç»Ÿæ–¹æ³•
python -m pytest tests/ -v
```

### æœ¬åœ°è°ƒè¯•å’Œæµ‹è¯•

#### ä½¿ç”¨MCP Inspectorè°ƒè¯•
MCP Inspectoræ˜¯å®˜æ–¹æä¾›çš„å¯è§†åŒ–è°ƒè¯•å·¥å…·ï¼ˆä½†æ˜¯æˆ‘ä¸ä¼šç”¨ï¼Œç»™ä¸äº†å»ºè®®ï¼Œè´´ä¸€ä»½å®˜æ–¹çš„ä»£ç ï¼‰
```
npx @modelcontextprotocol/inspector \
  uv \
  --directory path/to/server \
  run \
  package-name \
  args...
```

#### ä½¿ç”¨å®¢æˆ·ç«¯è°ƒè¯•

ç›´æ¥è¦æ±‚llmä½¿ç”¨å·¥å…·å¹¶æŸ¥çœ‹è¿”å›å†…å®¹


### ä»£ç ç»“æ„
```
src/
â”œâ”€â”€ mcp_server/          # MCP åè®®å®ç°
â”œâ”€â”€ core_service.py      # ä¸šåŠ¡é€»è¾‘å±‚
â”œâ”€â”€ parsers/            # æ ¼å¼ç‰¹å®šè§£æå™¨
â”œâ”€â”€ converters/         # HTML è½¬æ¢
â”œâ”€â”€ models/             # æ•°æ®æ¨¡å‹å’Œå·¥å…·å®šä¹‰
â””â”€â”€ utils/              # å·¥å…·å‡½æ•°
```

## ğŸ¤ è´¡çŒ®

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤æ‚¨çš„æ›´æ”¹ (`git commit -m 'Add amazing feature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. å¼€å¯ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦æƒ…è¯·å‚é˜… [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## ğŸ™ è‡´è°¢

- ä¸º [MCP](https://modelcontextprotocol.io/) è€Œæ„å»º
- ä¸“ä¸ºä¸ Claude Desktop æ— ç¼åä½œè€Œè®¾è®¡
- å—åˆ°è…¾è®¯çŠ€ç‰›é¸Ÿè®¡åˆ’ï¼Œæ”¹å–„ llm è¡¨æ ¼é›†æˆéœ€æ±‚çš„å¯å‘
