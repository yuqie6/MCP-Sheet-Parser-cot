<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ sheet_name or 'Spreadsheet' }}</title>
    <style>
        {{ default_css }}
    </style>
</head>
<body>
    <div class="container">
        {% if sheet_name %}
        <h1>{{ sheet_name }}</h1>
        {% endif %}
        
        <table>
            {% for row in rows %}
            <tr>
                {% for cell in row.cells %}
                {% if not cell.is_merged_continuation %}
                <{{ cell.tag }}
                    {% if cell.style %}style="{{ cell.style }}"{% endif %}
                    {% if cell.colspan > 1 %}colspan="{{ cell.colspan }}"{% endif %}
                    {% if cell.rowspan > 1 %}rowspan="{{ cell.rowspan }}"{% endif %}
                    {% if cell.is_merged %}class="merged-cell"{% endif %}
                >
                    {{ cell.value if cell.value is not none else '' }}
                </{{ cell.tag }}>
                {% endif %}
                {% endfor %}
            </tr>
            {% endfor %}
        </table>
        
        {% if metadata %}
        <div class="metadata">
            <h3>Metadata</h3>
            <ul>
                {% if metadata.total_rows %}
                <li>Total Rows: {{ metadata.total_rows }}</li>
                {% endif %}
                {% if metadata.total_columns %}
                <li>Total Columns: {{ metadata.total_columns }}</li>
                {% endif %}
                {% if metadata.merged_cells_count %}
                <li>Merged Cells: {{ metadata.merged_cells_count }}</li>
                {% endif %}
                {% if metadata.file_format %}
                <li>Source Format: {{ metadata.file_format }}</li>
                {% endif %}
            </ul>
        </div>
        {% endif %}
    </div>
</body>
</html>
